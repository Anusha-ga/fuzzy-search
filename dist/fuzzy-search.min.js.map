{"version":3,"sources":["fuzzy-search.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","Object","defineProperty","value","library","items","error","map","item","i","Array","isArray","string","escapeExp","search","term","lib","success","matches","exact","fuzzy","exactMatches","fuzzyMatches","exactFindExp","fuzzyFindExp","exactFindRegex","RegExp","replChars","split","join","fuzzyFindRegex","forEach","match","push","substringResult","getSubstrings","_matchType","_substrings","substrings","_score","score","count","concat","length","sort","sortByMatchScore","_regex","replace","regexString","matchString","regex","matchArray","exec","isMatch","missingCount","startsWith","str","a","b"],"mappings":"CAAA,SAA2CA,EAAMC,GAC1B,gBAAZC,UAA0C,gBAAXC,QACxCA,OAAOD,QAAUD,IACQ,kBAAXG,SAAyBA,OAAOC,IAC9CD,UAAWH,GACe,gBAAZC,SACdA,QAAY,GAAID,IAEhBD,EAAS,GAAIC,KACZK,KAAM,WACT,MAAgB,UAAUC,GAKhB,QAASC,GAAoBC,GAG5B,GAAGC,EAAiBD,GACnB,MAAOC,GAAiBD,GAAUP,OAGnC,IAAIC,GAASO,EAAiBD,IAC7BP,WACAS,GAAIF,EACJG,QAAQ,EAUT,OANAL,GAAQE,GAAUI,KAAKV,EAAOD,QAASC,EAAQA,EAAOD,QAASM,GAG/DL,EAAOS,QAAS,EAGTT,EAAOD,QAvBf,GAAIQ,KAqCJ,OATAF,GAAoBM,EAAIP,EAGxBC,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,GAGjBR,EAAoB,KAK/B,SAASL,EAAQD,GAEtB,YAEAe,QAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GAST,IAAIC,GAAU,SAAiBC,GAC7B,GAAIC,GAAQ,MAsBZ,OArBAD,GAAQA,EAAME,IAAI,SAAUC,EAAMC,GAEhC,MAAIC,OAAMC,QAAQH,IAChBF,EAAQ,wBAA0BE,EAC3B,MAEkB,gBAATA,IACPb,GAAIc,EAAI,EAAGG,OAAQJ,GAElBA,EAAKI,OAILJ,EAAKb,GAIRa,GAHPA,EAAKb,GAAKc,EAAI,EACPD,IALPF,EAAQ,oBAAsBE,EACvB,QAUPF,GAAgBA,MAAOA,EAAOD,MAAOA,GAClCA,GAyFLQ,GA3ES3B,EAAQ4B,OAAS,SAAgBC,EAAMC,GAElD,IAAKD,EAAM,OAASE,SAAS,EAAOX,MAAO,4CAC3C,KAAKU,EAAK,OAASC,SAAS,EAAOX,MAAO,2CAG1C,IADAU,EAAMZ,EAAQY,GACVA,EAAIV,MAAO,OAASW,SAAS,EAAOX,MAAOU,EAAIV,MAGnD,IAAIY,IAAYC,SAAWC,UAEvBC,KACAC,KAGAC,EAAe,KACfC,EAAe,IAKnBD,GAAe,SAAWV,EAAUE,GAAQ,SAC5C,IAAIU,GAAiB,GAAIC,QAAOH,EAAc,KAM1CI,EAAYZ,EAAKa,MAAM,IAAIrB,IAAI,SAAUE,GAC3C,MAAO,IAAMI,EAAUJ,GAAK,KAI9Be,GAAe,QAAUG,EAAUE,KAAK,SAAW,QACnD,IAAIC,GAAiB,GAAIJ,QAAOF,EAAc,IA2B9C,OAxBAR,GAAIe,QAAQ,SAAUvB,GAChBA,EAAKI,OAAOoB,MAAMP,GACpBJ,EAAaY,KAAKzB,GACTA,EAAKI,OAAOoB,MAAMF,IAC3BR,EAAaW,KAAKzB,KAKtBa,EAAaU,QAAQ,SAAUC,GAE7B,GAAIE,GAAkBC,EAAcZ,EAAcS,EAAMpB,OACxDoB,GAAMI,WAAa,QAASJ,EAAMK,YAAcH,EAAgBI,WAAYN,EAAMO,OAASL,EAAgBM,MAC3GtB,EAAQC,MAAMc,KAAKD,KAGrBV,EAAaS,QAAQ,SAAUC,GAE7B,GAAIE,GAAkBC,EAAcX,EAAcQ,EAAMpB,OACxDoB,GAAMI,WAAa,QAASJ,EAAMK,YAAcH,EAAgBI,WAAYN,EAAMO,OAASL,EAAgBM,MAC3GtB,EAAQE,MAAMa,KAAKD,MAKnBf,SAAS,EACTwB,MAAOvB,EAAQC,MAAMuB,OAAOxB,EAAQE,OAAOuB,OAC3C5B,KAAMA,EACNI,MAAOD,EAAQC,MAAMyB,KAAKC,GAC1BzB,MAAOF,EAAQE,MAAMwB,KAAKC,GAC1BC,QACE3B,MAAOI,EACPH,MAAOI,KAMG,SAAmBT,GACjC,MAAOA,GAAKgC,QAAQ,oCAAqC,UAIvDZ,EAAgB,SAAuBa,EAAaC,GAOtD,IAAK,GANDC,GAAQ,GAAIxB,QAAOsB,EAAa,KAChCG,EAAaD,EAAME,KAAKH,GACxBX,KACAe,GAAU,EACVC,EAAe,EACfC,EAAa,EACR9C,EAAI,EAAGA,EAAI0C,EAAWR,OAAQlC,IACjC0C,EAAW1C,IAAI6B,EAAWL,MAAOuB,IAAKL,EAAW1C,GAAIuB,MAAOqB,IAE3DF,EAAW1C,IAAY,IAANA,GAAWA,IAAM0C,EAAWR,OAAS,GAAGW,IAEzDH,EAAW1C,IAAY,IAANA,GAAS8C,IAC/BF,GAAWA,CAEb,QAASf,WAAYA,EAAYE,MAAOc,EAAeC,IAIrDV,EAAmB,SAA0BY,EAAGC,GAClD,MAAID,GAAElB,OAASmB,EAAEnB,OAAe,EAC5BkB,EAAElB,OAASmB,EAAEnB,QAAe,EACzB","file":"fuzzy-search.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"FS\"] = factory();\n\telse\n\t\troot[\"FS\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t/*\n\t  library(terms)\n\t    take an array of strings, return a fuzzy lib to use in fuzzySearch\n\t  Usage\n\t  FS.library(['hello', 'lingo']]);\n\t*/\n\t\n\tvar library = function library(items) {\n\t  var error = void 0;\n\t  items = items.map(function (item, i) {\n\t    // if it is an array\n\t    if (Array.isArray(item)) {\n\t      error = 'no arrays permitted: ' + item;\n\t      return null;\n\t      // if it is a string\n\t    } else if (typeof item === 'string') {\n\t      return { id: i + 1, string: item };\n\t      // no string value\n\t    } else if (!item.string) {\n\t      error = 'no string value: ' + item;\n\t      return null;\n\t      // no id value\n\t    } else if (!item.id) {\n\t      item.id = i + 1;\n\t      return item;\n\t    } else {\n\t      return item;\n\t    }\n\t  });\n\t\n\t  if (error) return { error: error, items: items };\n\t  return items;\n\t};\n\t\n\t/*\n\t  FS.search(term, lib)\n\t    take a search term and an array of fuzzyObjects, return prioritized match arrays\n\t    exact array contains exact substring\n\t    fuzzy array contains partial substrings\n\t  {term} = search term\n\t  {lib}  = list of {id, string} to search\n\t  Usage\n\t  FS.search('lo', [{id: 1, string: 'hello'}, {id: 2, string: 'lingo'}]);\n\t*/\n\t\n\tvar search = exports.search = function search(term, lib) {\n\t  // require params\n\t  if (!term) return { success: false, error: 'No term provided in FS.search(term, lib).' };\n\t  if (!lib) return { success: false, error: 'No lib provided in FS.search(term, lib).' };\n\t\n\t  lib = library(lib);\n\t  if (lib.error) return { success: false, error: lib.error };\n\t\n\t  // destination of matches, to be iterated over and transformed into output matches\n\t  var matches = { exact: [], fuzzy: [] };\n\t  // temp destinations for matches\n\t  var exactMatches = [];\n\t  var fuzzyMatches = [];\n\t\n\t  // to be defined and returned in output\n\t  var exactFindExp = null;\n\t  var fuzzyFindExp = null;\n\t\n\t  // build replace regular expressions and vars\n\t  // exact: wrap exact match in span\n\t  // 'abc' => (.+)?(abc)(.+)?$\n\t  exactFindExp = '(.+)?(' + escapeExp(term) + ')(.+)?$';\n\t  var exactFindRegex = new RegExp(exactFindExp, 'g');\n\t\n\t  // fuzzy: wrapping first letter match in span for each letter\n\t  // 'abc' => (.+)?(a)(.+)?(b)(.+)?(c)(.+)?$\n\t  // term to array\n\t  // for each in array, wrap in () for regex grouping\n\t  var replChars = term.split('').map(function (i) {\n\t    return '(' + escapeExp(i) + ')';\n\t  });\n\t\n\t  // join () groups with wildcard in-between groups\n\t  fuzzyFindExp = '(.+)?' + replChars.join('(.+)?') + '(.+)?$';\n\t  var fuzzyFindRegex = new RegExp(fuzzyFindExp, 'g');\n\t\n\t  // find the matches in the library\n\t  lib.forEach(function (item) {\n\t    if (item.string.match(exactFindRegex)) {\n\t      exactMatches.push(item);\n\t    } else if (item.string.match(fuzzyFindRegex)) {\n\t      fuzzyMatches.push(item);\n\t    }\n\t  });\n\t\n\t  // package the matches up\n\t  exactMatches.forEach(function (match) {\n\t    // find the match\n\t    var substringResult = getSubstrings(exactFindExp, match.string);\n\t    match._matchType = 'exact', match._substrings = substringResult.substrings, match._score = substringResult.score;\n\t    matches.exact.push(match);\n\t  });\n\t\n\t  fuzzyMatches.forEach(function (match) {\n\t    // find the match\n\t    var substringResult = getSubstrings(fuzzyFindExp, match.string);\n\t    match._matchType = 'fuzzy', match._substrings = substringResult.substrings, match._score = substringResult.score;\n\t    matches.fuzzy.push(match);\n\t  });\n\t\n\t  // output\n\t  return {\n\t    success: true,\n\t    count: matches.exact.concat(matches.fuzzy).length,\n\t    term: term,\n\t    exact: matches.exact.sort(sortByMatchScore),\n\t    fuzzy: matches.fuzzy.sort(sortByMatchScore),\n\t    _regex: {\n\t      exact: exactFindExp,\n\t      fuzzy: fuzzyFindExp\n\t    }\n\t  };\n\t};\n\t\n\t// escape regex-reserved chars\n\tvar escapeExp = function escapeExp(term) {\n\t  return term.replace(/([\\/\\\\\\*\\?\\+\\.\\(\\)\\[\\]\\{\\}\\$\\!])/g, '\\\\$1');\n\t};\n\t\n\t// get substrings\n\tvar getSubstrings = function getSubstrings(regexString, matchString) {\n\t  var regex = new RegExp(regexString, 'g');\n\t  var matchArray = regex.exec(matchString);\n\t  var substrings = [];\n\t  var isMatch = false;\n\t  var missingCount = 0;\n\t  var startsWith = 0;\n\t  for (var i = 1; i < matchArray.length; i++) {\n\t    if (matchArray[i]) substrings.push({ str: matchArray[i], match: isMatch });\n\t    // if undefined and not first or last, add a point because it's a match combo\n\t    if (!matchArray[i] && i !== 1 && i !== matchArray.length - 1) missingCount++;\n\t    // if first is undefined, string starts with match\n\t    if (!matchArray[i] && i === 1) startsWith++;\n\t    isMatch = !isMatch;\n\t  }\n\t  return { substrings: substrings, score: missingCount + startsWith };\n\t};\n\t\n\t// sort matches by score descending\n\tvar sortByMatchScore = function sortByMatchScore(a, b) {\n\t  if (a._score < b._score) return 1;\n\t  if (a._score > b._score) return -1;\n\t  return 0;\n\t};\n\n/***/ }\n/******/ ])\n});\n;\n"],"sourceRoot":"/source/"}